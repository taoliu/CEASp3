#!/usr/bin/env python3
"""Wrapper for sitepro supporting wig and bigwig formats.
Default format is bigwig.
"""
import sys
from pathlib import Path

# expose dump for tests and external use from bigwig implementation
SCRIPT_DIR = Path(__file__).resolve().parent
sys.path.insert(0, str(SCRIPT_DIR))
from sitepro_bigwig import dump  # re-export


def main():
    fmt = 'bigwig'
    argv = sys.argv
    for flag in ('--format', '-f'):
        if flag in argv:
            idx = argv.index(flag)
            if idx + 1 < len(argv):
                fmt = argv[idx + 1].lower()
                del argv[idx:idx + 2]
            else:
                argv[idx:idx + 1] = []
            break
    if fmt == 'wig':
        import sitepro_wig as impl
    else:
        import sitepro_bigwig as impl
    impl.main()


if __name__ == '__main__':
    main()
